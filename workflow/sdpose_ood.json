{"id":"1bc4458c-a13c-41de-aa48-4bfd5200441b","revision":0,"last_node_id":60,"last_link_id":126,"nodes":[{"id":48,"type":"VHS_LoadVideo","pos":[753.5818705923772,1043.1540168316258],"size":[253.279296875,738.4962614002146],"flags":{},"order":0,"mode":0,"inputs":[{"localized_name":"meta_batch","name":"meta_batch","shape":7,"type":"VHS_BatchManager","link":null},{"localized_name":"vae","name":"vae","shape":7,"type":"VAE","link":null},{"localized_name":"video","name":"video","type":"COMBO","widget":{"name":"video"},"link":null},{"localized_name":"force_rate","name":"force_rate","type":"FLOAT","widget":{"name":"force_rate"},"link":null},{"localized_name":"custom_width","name":"custom_width","type":"INT","widget":{"name":"custom_width"},"link":null},{"localized_name":"custom_height","name":"custom_height","type":"INT","widget":{"name":"custom_height"},"link":null},{"localized_name":"frame_load_cap","name":"frame_load_cap","type":"INT","widget":{"name":"frame_load_cap"},"link":null},{"localized_name":"skip_first_frames","name":"skip_first_frames","type":"INT","widget":{"name":"skip_first_frames"},"link":null},{"localized_name":"select_every_nth","name":"select_every_nth","type":"INT","widget":{"name":"select_every_nth"},"link":null},{"localized_name":"format","name":"format","shape":7,"type":"COMBO","widget":{"name":"format"},"link":null}],"outputs":[{"localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[]},{"localized_name":"frame_count","name":"frame_count","type":"INT","links":null},{"localized_name":"audio","name":"audio","type":"AUDIO","links":null},{"localized_name":"video_info","name":"video_info","type":"VHS_VIDEOINFO","links":null}],"properties":{"cnr_id":"comfyui-videohelpersuite","ver":"8550981384301e9bc5bfea83e5c2c75258102593","Node name for S&R":"VHS_LoadVideo"},"widgets_values":{"video":"19-工程结算，摇一个-1080P 高清-AVC.mp4","force_rate":0,"custom_width":0,"custom_height":0,"frame_load_cap":10,"skip_first_frames":300,"select_every_nth":1,"format":"AnimateDiff","choose video to upload":"image","videopreview":{"hidden":false,"paused":false,"params":{"filename":"19-工程结算，摇一个-1080P 高清-AVC.mp4","type":"input","format":"video/mp4","force_rate":0,"custom_width":0,"custom_height":0,"frame_load_cap":10,"skip_first_frames":300,"select_every_nth":1}}}},{"id":32,"type":"VHS_VideoCombine","pos":[2003.3103839086075,1120.0760877632765],"size":[220.5830078125,334],"flags":{},"order":9,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":120},{"localized_name":"audio","name":"audio","shape":7,"type":"AUDIO","link":null},{"localized_name":"meta_batch","name":"meta_batch","shape":7,"type":"VHS_BatchManager","link":null},{"localized_name":"vae","name":"vae","shape":7,"type":"VAE","link":null},{"localized_name":"frame_rate","name":"frame_rate","type":"FLOAT","widget":{"name":"frame_rate"},"link":null},{"localized_name":"loop_count","name":"loop_count","type":"INT","widget":{"name":"loop_count"},"link":null},{"localized_name":"filename_prefix","name":"filename_prefix","type":"STRING","widget":{"name":"filename_prefix"},"link":null},{"localized_name":"format","name":"format","type":"COMBO","widget":{"name":"format"},"link":null},{"localized_name":"pingpong","name":"pingpong","type":"BOOLEAN","widget":{"name":"pingpong"},"link":null},{"localized_name":"save_output","name":"save_output","type":"BOOLEAN","widget":{"name":"save_output"},"link":null},{"name":"pix_fmt","type":["yuv420p","yuv420p10le"],"widget":{"name":"pix_fmt"},"link":null},{"name":"crf","type":"INT","widget":{"name":"crf"},"link":null},{"name":"save_metadata","type":"BOOLEAN","widget":{"name":"save_metadata"},"link":null},{"name":"trim_to_audio","type":"BOOLEAN","widget":{"name":"trim_to_audio"},"link":null}],"outputs":[{"localized_name":"Filenames","name":"Filenames","type":"VHS_FILENAMES","links":null}],"properties":{"cnr_id":"comfyui-videohelpersuite","ver":"8550981384301e9bc5bfea83e5c2c75258102593","Node name for S&R":"VHS_VideoCombine","aux_id":"Kosinkadink/ComfyUI-VideoHelperSuite"},"widgets_values":{"frame_rate":30,"loop_count":0,"filename_prefix":"AnimateDiff","format":"video/h264-mp4","pix_fmt":"yuv420p","crf":19,"save_metadata":true,"trim_to_audio":false,"pingpong":false,"save_output":false,"videopreview":{"hidden":false,"paused":false,"params":{"filename":"AnimateDiff_00003.mp4","subfolder":"","type":"temp","format":"video/h264-mp4","frame_rate":30,"workflow":"AnimateDiff_00003.png","fullpath":"C:\\mysoft\\ComfyUI\\temp\\AnimateDiff_00003.mp4"}}}},{"id":45,"type":"LoadImage","pos":[1032.445669746528,1165.190941518326],"size":[270,314],"flags":{},"order":1,"mode":0,"inputs":[{"localized_name":"图像","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"localized_name":"选择文件上传","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[118,120,126]},{"localized_name":"遮罩","name":"MASK","type":"MASK","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.3.66","Node name for S&R":"LoadImage"},"widgets_values":["eligen_00034_.png","image"]},{"id":18,"type":"Note","pos":[1295.668791203465,1557.838806386414],"size":[776.3567180428074,291.2611697064141],"flags":{},"order":2,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["body 模型为17个点的仅身体姿态；wholebody模型为包括面部和手指的133点的姿态\n30系以上显卡推荐bf16，更早的使用fp16。16精度速度不变显存占用降低。\ncpu推理仅可用fp32\n\nscore threshold控制识别效果\noverlay alpha控制结果图背景可见度。1代表纯黑背景的仅姿态图\nbatch_size最初设计目的为并行运行增加速度，后来发现并行了也没什么区别。可能类似4090这种高算力的能有区别吧。但是修改太麻烦于是保留。正常用1即可。\n\ndata_from_florence2接受来自https://github.com/kijai/ComfyUI-Florence2.git\n节点的“data输出”，需注意需切换识别模式为 caption_to_phrase_grounding,并使用英文提示词指定想要识别的对象。可用people、human等识别所有、man、woman等仅识别特定性别，或其他特征的人物。\n\ngrounding_dion_model链接groundingdino model节点，以使用groundingdino来识别图中人物。在节点的prompt输入里输入groundingdino所识别的对象。参数gd_threshold控制groundingdino识别效果。速度最慢\n\nyolo_model接受load yolo model节点输入，使用yolo来生成bbox。速度最快\n\n\n以上三种方式均选其中一种，都不使用则直接识别全图，多人时可能识别不全。\n\n\nsave for editor选项开启后，可在output/poses下找到pose_edit前缀的姿态json文件，用于https://github.com/judian17/ComfyUI-OpenPose-Editor-jd 此节点导入并编辑姿态。\n注意保存的json格式与输出的字符串类型的pose_json不太一样，后者为项目自带格式，无法用于上述节点的导入编辑\n\n当使用wholebody模型时，可通过keep face、keep hands、keep feet参数控制是否输出面部、手指、脚的点。使用body模型时无用。"],"color":"#432","bgcolor":"#653"},{"id":44,"type":"Note","pos":[1040.1789855910004,1034.998324149427],"size":[210,88],"flags":{},"order":3,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["可加载视频或图片"],"color":"#432","bgcolor":"#653"},{"id":54,"type":"GroundingDinoModelLoader_SDPose","pos":[1316.0148395732117,1266.5764698982034],"size":[341.905859375,58],"flags":{},"order":4,"mode":0,"inputs":[{"localized_name":"model_name","name":"model_name","type":"COMBO","widget":{"name":"model_name"},"link":null}],"outputs":[{"localized_name":"GROUNDING_DINO_MODEL","name":"GROUNDING_DINO_MODEL","type":"GROUNDING_DINO_MODEL","links":[]}],"properties":{"aux_id":"judian17/ComfyUI-SDPose-OOD","ver":"6addae981fb0346a3b9a7cea8d0541a5548817b7","Node name for S&R":"GroundingDinoModelLoader_SDPose"},"widgets_values":["GroundingDINO_SwinB (938MB)"]},{"id":40,"type":"YOLOModelLoader","pos":[1342.0166034722358,1406.036431383735],"size":[270,58],"flags":{},"order":5,"mode":0,"inputs":[{"localized_name":"model_name","name":"model_name","type":"COMBO","widget":{"name":"model_name"},"link":null}],"outputs":[{"localized_name":"YOLO_MODEL","name":"YOLO_MODEL","type":"YOLO_MODEL","links":[]}],"properties":{"aux_id":"judian17/ComfyUI-SDPose-OOD","ver":"c5953e1e112665340c642387129f1bc50fcf3dfa","Node name for S&R":"YOLOModelLoader"},"widgets_values":["yolo11x.pt"]},{"id":59,"type":"Note","pos":[861.5639388065262,777.222864913241],"size":[210,88],"flags":{},"order":6,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["可选择使用florence2节点、groundingdino、yolo或均不使用"],"color":"#432","bgcolor":"#653"},{"id":51,"type":"Florence2Run","pos":[1273.4606572797124,628.5796150419711],"size":[400,369],"flags":{},"order":10,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"IMAGE","link":118},{"localized_name":"florence2_model","name":"florence2_model","type":"FL2MODEL","link":91},{"localized_name":"text_input","name":"text_input","type":"STRING","widget":{"name":"text_input"},"link":null},{"localized_name":"task","name":"task","type":"COMBO","widget":{"name":"task"},"link":null},{"localized_name":"fill_mask","name":"fill_mask","type":"BOOLEAN","widget":{"name":"fill_mask"},"link":null},{"localized_name":"keep_model_loaded","name":"keep_model_loaded","shape":7,"type":"BOOLEAN","widget":{"name":"keep_model_loaded"},"link":null},{"localized_name":"max_new_tokens","name":"max_new_tokens","shape":7,"type":"INT","widget":{"name":"max_new_tokens"},"link":null},{"localized_name":"num_beams","name":"num_beams","shape":7,"type":"INT","widget":{"name":"num_beams"},"link":null},{"localized_name":"do_sample","name":"do_sample","shape":7,"type":"BOOLEAN","widget":{"name":"do_sample"},"link":null},{"localized_name":"output_mask_select","name":"output_mask_select","shape":7,"type":"STRING","widget":{"name":"output_mask_select"},"link":null},{"localized_name":"seed","name":"seed","shape":7,"type":"INT","widget":{"name":"seed"},"link":null}],"outputs":[{"localized_name":"image","name":"image","type":"IMAGE","links":[92]},{"localized_name":"mask","name":"mask","type":"MASK","links":null},{"localized_name":"caption","name":"caption","type":"STRING","links":[]},{"localized_name":"data","name":"data","type":"JSON","links":[124]}],"properties":{"cnr_id":"comfyui-florence2","ver":"00b63382966a444a9fefacb65b8deb188d12a458","Node name for S&R":"Florence2Run","aux_id":"kijai/ComfyUI-Florence2"},"widgets_values":["human","caption_to_phrase_grounding",true,false,1024,3,true,"",2,"fixed",[false,true]]},{"id":52,"type":"PreviewImage","pos":[1835.548753050627,636.2609251561124],"size":[229.90386295916687,395.228218022673],"flags":{},"order":11,"mode":0,"inputs":[{"localized_name":"图像","name":"images","type":"IMAGE","link":92}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.66","Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":50,"type":"Florence2ModelLoader","pos":[837.1175543941788,586.4048382877829],"size":[288.740234375,130],"flags":{},"order":7,"mode":0,"inputs":[{"localized_name":"lora","name":"lora","shape":7,"type":"PEFTLORA","link":null},{"localized_name":"model","name":"model","type":"COMBO","widget":{"name":"model"},"link":null},{"localized_name":"precision","name":"precision","type":"COMBO","widget":{"name":"precision"},"link":null},{"localized_name":"attention","name":"attention","type":"COMBO","widget":{"name":"attention"},"link":null},{"localized_name":"convert_to_safetensors","name":"convert_to_safetensors","shape":7,"type":"BOOLEAN","widget":{"name":"convert_to_safetensors"},"link":null}],"outputs":[{"localized_name":"florence2_model","name":"florence2_model","type":"FL2MODEL","links":[91]}],"properties":{"cnr_id":"comfyui-florence2","ver":"00b63382966a444a9fefacb65b8deb188d12a458","Node name for S&R":"Florence2ModelLoader","aux_id":"kijai/ComfyUI-Florence2"},"widgets_values":["Florence-2-large-PromptGen-v2.0","fp16","sdpa",false]},{"id":39,"type":"SDPoseOODLoader","pos":[1334.1057814493638,1083.9627438245636],"size":[270,130],"flags":{},"order":8,"mode":0,"inputs":[{"localized_name":"model_type","name":"model_type","type":"COMBO","widget":{"name":"model_type"},"link":null},{"localized_name":"unet_precision","name":"unet_precision","type":"COMBO","widget":{"name":"unet_precision"},"link":null},{"localized_name":"device","name":"device","type":"COMBO","widget":{"name":"device"},"link":null},{"localized_name":"unload_on_finish","name":"unload_on_finish","type":"BOOLEAN","widget":{"name":"unload_on_finish"},"link":null}],"outputs":[{"localized_name":"SDPOSE_MODEL","name":"SDPOSE_MODEL","type":"SDPOSE_MODEL","links":[122]}],"properties":{"aux_id":"judian17/ComfyUI-SDPose-OOD","ver":"c5953e1e112665340c642387129f1bc50fcf3dfa","Node name for S&R":"SDPoseOODLoader"},"widgets_values":["Body","bf16","cuda",false]},{"id":46,"type":"PreviewImage","pos":[2284.9081730752237,1180.1393989798091],"size":[140,246],"flags":{},"order":13,"mode":0,"inputs":[{"localized_name":"图像","name":"images","type":"IMAGE","link":125}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.66","Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":58,"type":"SDPoseOODProcessor","pos":[1697.8629829878914,1132.2582805592876],"size":[287.806640625,354],"flags":{},"order":12,"mode":0,"inputs":[{"localized_name":"sdpose_model","name":"sdpose_model","type":"SDPOSE_MODEL","link":122},{"localized_name":"images","name":"images","type":"IMAGE","link":126},{"localized_name":"data_from_florence2","name":"data_from_florence2","shape":7,"type":"JSON","link":124},{"localized_name":"grounding_dino_model","name":"grounding_dino_model","shape":7,"type":"GROUNDING_DINO_MODEL","link":null},{"localized_name":"yolo_model","name":"yolo_model","shape":7,"type":"YOLO_MODEL","link":null},{"localized_name":"score_threshold","name":"score_threshold","type":"FLOAT","widget":{"name":"score_threshold"},"link":null},{"localized_name":"overlay_alpha","name":"overlay_alpha","type":"FLOAT","widget":{"name":"overlay_alpha"},"link":null},{"localized_name":"batch_size","name":"batch_size","type":"INT","widget":{"name":"batch_size"},"link":null},{"localized_name":"prompt","name":"prompt","shape":7,"type":"STRING","widget":{"name":"prompt"},"link":null},{"localized_name":"gd_threshold","name":"gd_threshold","shape":7,"type":"FLOAT","widget":{"name":"gd_threshold"},"link":null},{"localized_name":"save_for_editor","name":"save_for_editor","shape":7,"type":"BOOLEAN","widget":{"name":"save_for_editor"},"link":null},{"localized_name":"filename_prefix_edit","name":"filename_prefix_edit","shape":7,"type":"STRING","widget":{"name":"filename_prefix_edit"},"link":null},{"localized_name":"keep_face","name":"keep_face","shape":7,"type":"BOOLEAN","widget":{"name":"keep_face"},"link":null},{"localized_name":"keep_hands","name":"keep_hands","shape":7,"type":"BOOLEAN","widget":{"name":"keep_hands"},"link":null},{"localized_name":"keep_feet","name":"keep_feet","shape":7,"type":"BOOLEAN","widget":{"name":"keep_feet"},"link":null}],"outputs":[{"localized_name":"images","name":"images","type":"IMAGE","links":[125]},{"localized_name":"pose_jsons","name":"pose_jsons","type":"STRING","links":null}],"properties":{"aux_id":"judian17/ComfyUI-SDPose-OOD","ver":"6addae981fb0346a3b9a7cea8d0541a5548817b7","Node name for S&R":"SDPoseOODProcessor"},"widgets_values":[0.3,0.6,1,"person .",0.3,false,"poses/pose_edit",false,false,true]}],"links":[[91,50,0,51,1,"FL2MODEL"],[92,51,0,52,0,"IMAGE"],[118,45,0,51,0,"IMAGE"],[120,45,0,32,0,"IMAGE"],[122,39,0,58,0,"SDPOSE_MODEL"],[124,51,3,58,2,"JSON"],[125,58,0,46,0,"IMAGE"],[126,45,0,58,1,"IMAGE"]],"groups":[],"config":{},"extra":{"ds":{"scale":1.0152559799477083,"offset":[-358.22491995500013,-518.0191332742753]}},"version":0.4}